# Cloudreve-AfdianPay

Cloudreveè‡ªå®šä¹‰ä»˜æ¬¾æ¸ é“-çˆ±å‘ç”µæ¥å£

å‚è€ƒ https://docs.cloudreve.org/use/pro/pay æ„å»º

æ¨èä½¿ç”¨ **Python3.11**

## ä½¿ç”¨æ–¹æ³•

### éƒ¨ç½²

ä½¿ç”¨çˆ±å‘ç”µæ¥å£

- éœ€è¦å…ˆ[æ³¨å†Œçˆ±å‘ç”µ](https://afdian.net/)è´¦æˆ·
- åœ¨[å¼€å‘äººå‘˜é¡µé¢](https://afdian.net/dashboard/dev)è·å–**user_id**
- åœ¨[å¼€å‘äººå‘˜é¡µé¢](https://afdian.net/dashboard/dev)åº•éƒ¨è·å–**API Token**

------

~~å¯ä»¥åœ¨[Cloudreve-AfdianPay-Buildä»“åº“](https://github.com/essesoul/Cloudreve-AfdianPay-Build)ä¸‹è½½ç¼–è¯‘å¥½çš„æ–‡ä»¶ç›´æ¥è¿è¡Œï¼Œæˆ–è€…è‡ªè¡Œé…ç½®è¿è¡Œç¯å¢ƒ~~ï¼ˆå­˜åœ¨é—®é¢˜ï¼Œåé¢æœ‰ç©ºäº†å†ä¿®å¤ï¼‰

------

ä¸‹è½½ `src` æ–‡ä»¶å¤¹ï¼Œè¿è¡Œ `pip install -r requirements.txt` å®‰è£…ä¾èµ–åŒ…

ä¿®æ”¹ `.env` æ–‡ä»¶ä¸­çš„å†…å®¹

```
SITE_URL="ä½ çš„ç½‘ç«™urlï¼Œä¸å¸¦æ–œæ ï¼Œä¾‹å¦‚ https://demo.cloudreve.org"
USER_ID="ä½ çš„çˆ±å‘ç”µuser_id"
TOKEN="ä½ çš„çˆ±å‘ç”µapi token"
PORT="5000"# ç›‘å¬ç«¯å£ï¼Œé»˜è®¤5000
```

ä¾‹å¦‚

```
SITE_URL="https://demo.cloudreve.org"
USER_ID="abcxxxxxxx123"
TOKEN="aAABBB123xxxxzzz"
PORT="5000"
```

è¿è¡Œ `cloudreve_pay.py` æ–‡ä»¶å³å¯

é»˜è®¤ç›‘å¬5000ç«¯å£ï¼Œå¯ä»¥è‡ªè¡Œä¿®æ”¹ `.env` æ–‡ä»¶çš„ `PORT` å‚æ•°

```
PORT="5000"# ç›‘å¬ç«¯å£ï¼Œé»˜è®¤5000
```

------

### é…ç½®

åœ¨[çˆ±å‘ç”µå¼€å‘è€…é¡µé¢](https://afdian.net/dashboard/dev)è®¾ç½®**Webhook URL** `http://example.com:5000/afdian`
å°† `example.com` æ›´æ¢ä¸ºä½ çš„åŸŸåæˆ–IPï¼Œç‚¹å‡»ä¿å­˜

å¦‚æœæ²¡æœ‰æŠ¥é”™åˆ™è¯´æ˜æˆåŠŸ

åœ¨Cloudreveç®¡ç†åå°-å‚æ•°è®¾ç½®-å¢å€¼æœåŠ¡-è‡ªå®šä¹‰ä»˜æ¬¾æ¸ é“ä¸­å¡«å†™ä»˜æ¬¾æ–¹å¼åç§°ã€æ”¯ä»˜æ¥å£åœ°å€ã€é€šä¿¡å¯†é’¥

æ¥å£åœ°å€ä¸ºï¼š `http://example.com:5000/order/create`  å°† `example.com` æ›´æ¢ä¸ºä½ çš„åŸŸåæˆ–IPï¼Œç‚¹å‡»ä¿å­˜

é€šä¿¡å¯†é’¥å¯ä»¥éšæ„å¡«å†™ï¼Œæš‚æ—¶è¿˜æ²¡åŠ å…¥ç­¾åéªŒè¯ï¼Œåé¢æœ‰ç©ºäº†å†æ›´æ–°

------

### **è¿‘æœŸçš„ä¸€æ¬¡æ›´æ–°ä¸­å·²å¢åŠ äº†ä¸»åŠ¨è°ƒç”¨APIéªŒè¯æ•°æ®çœŸå®æ€§çš„åŠŸèƒ½ï¼Œå¯ä»¥ä¸å†è¿›è¡Œä¸‹é¢æ“ä½œ**ğŸ‰

### ~~âš ï¸å®‰å…¨äº‹é¡¹~~

~~ä¸ºäº†é˜²æ­¢ä¼ªé€ Postè¯·æ±‚ï¼Œ**å¼ºçƒˆå»ºè®®åœ¨æ­£å¼ä¸Šçº¿å‰æ›´æ”¹ `cloudreve_pay.py`
æ–‡ä»¶ä¸­[ç¬¬28è¡Œ](https://github.com/essesoul/Cloudreve-AfdianPay/blob/Beta-V0.0.1/src/cloudreve_pay.py#L28)
çš„postè·¯å¾„ï¼Œå¹¶åœ¨çˆ±å‘ç”µåå°åšç›¸åº”è°ƒæ•´**~~

~~åç»­æ›´æ–°ä¸­ä¼šåŠ å…¥APIä¸»åŠ¨è¯·æ±‚éªŒè¯è·å–ä¿¡æ¯çš„æ­£ç¡®æ€§~~

